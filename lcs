#include <stdio.h>
#include <string.h>

void printMatrix(int m, int n, int c[m+1][n+1], char X[], char Y[]) {
    printf("\nCost Matrix with Directions:\n\n");

    printf("      ");
    for (int j = 0; j < n; j++) {
        printf("   %c ", Y[j]);
    }
    printf("\n");

    for (int i = 0; i <= m; i++) {
        if (i == 0) printf("   "); 
        else printf(" %c ", X[i-1]);

        for (int j = 0; j <= n; j++) {
            if (i == 0 || j == 0) {
                printf(" %2d  ", c[i][j]);
            }
            else {
                if (X[i-1] == Y[j-1]) {
                    printf(" %2d↖ ", c[i][j]);
                } else if (c[i-1][j] >= c[i][j-1]) {
                    printf(" %2d↑ ", c[i][j]);
                } else {
                    printf(" %2d← ", c[i][j]);
                }
            }
        }
        printf("\n");
    }
}

void getLCS(int m, int n, int c[m+1][n+1], char X[], char Y[], char lcs[]) {
    int i = m, j = n;
    int index = c[m][n];
    lcs[index] = '\0';

    while (i > 0 && j > 0) {
        if (X[i-1] == Y[j-1]) {
            lcs[index-1] = X[i-1];
            i--; j--; index--;
        }
        else if (c[i-1][j] >= c[i][j-1]) {
            i--;
        }
        else {
            j--;
        }
    }
}

int LCS_length(char *X, char *Y, char *lcs) {
    int m = strlen(X);
    int n = strlen(Y);

    int c[m+1][n+1];

    for (int i = 0; i <= m; i++) c[i][0] = 0;
    for (int j = 0; j <= n; j++) c[0][j] = 0;

    for (int i = 1; i <= m; i++) {
        for (int j = 1; j <= n; j++) {
            if (X[i-1] == Y[j-1])
                c[i][j] = c[i-1][j-1] + 1;
            else if (c[i-1][j] >= c[i][j-1])
                c[i][j] = c[i-1][j];
            else
                c[i][j] = c[i][j-1];
        }
    }

    printMatrix(m, n, c, X, Y);
    getLCS(m, n, c, X, Y, lcs);

    return c[m][n];
}

int main() {
    char X[] = "AGCCCTAAGGGCTACCTAGCTT";
    char Y[] = "GACAGCCTACAAGCGTTAGCTTG";
    char lcs[100];

    int length = LCS_length(X, Y, lcs);

    printf("\nFinal Cost (Length of LCS) = %d\n", length);
    printf("LCS = %s\n", lcs);

    return 0;
}
